(defvar kensin-code-gen
  '(("9N001000000000001" . "身長")
    ("9N006000000000001" . "体重")
    ("9N011000000000001" . "ＢＭＩ")
    ("9N021000000000001" . "内臓脂肪面積")
    ("9N016160100000001" . "腹囲(実測）")
    ("9N016160200000001" . "腹囲(自己判定）")
    ("9N016160300000001" . "腹囲(自己申告）")
    ("9N026000000000002" . "肥満度")
    ("9N051000000000049" . "業務歴")
    ("9N056000000000011" . "既往歴")
    ("9N056160400000049" . "（具体的な既往歴）")
    ("9N061000000000011" . "自覚症状")
    ("9N061160800000049" . "（所見）")
    ("9N066000000000011" . "他覚症状")
    ("9N066160800000049" . "（所見）")
    ("9N071000000000049" . "その他（家族歴等）")
    ("9N076000000000049" . "視診（口腔内含む）")
    ("9N081000000000049" . "打聴診")
    ("9N086000000000049" . "触診（関節可動域含む）")
    ("9N091000000000001" . "反復唾液嚥下テスト")
    ("9A755000000000001" . "収縮期血圧（その他）")
    ("9A752000000000001" . "収縮期血圧（２回目）")
    ("9A751000000000001" . "収縮期血圧（１回目）")
    ("9A765000000000001" . "拡張期血圧（その他）")
    ("9A762000000000001" . "拡張期血圧（２回目）")
    ("9A761000000000001" . "拡張期血圧（１回目）")
    ("9N121000000000001" . "心拍数")
    ("9N141000000000011" . "採血時間（食後）")
    ("3F050000002327101" . "総コレステロール")
    ("3F050000002327201" . "総コレステロール")
    ("3F050000002399901" . "総コレステロール")
    ("3F015000002327101" . "中性脂肪（トリグリセリド）")
    ("3F015000002327201" . "中性脂肪（トリグリセリド）")
    ("3F015000002399901" . "中性脂肪（トリグリセリド）")
    ("3F070000002327101" . "ＨＤＬコレステロール")
    ("3F070000002327201" . "ＨＤＬコレステロール")
    ("3F070000002399901" . "ＨＤＬコレステロール")
    ("3F077000002327101" . "ＬＤＬコレステロール")
    ("3F077000002327201" . "ＬＤＬコレステロール")
    ("3F077000002399901" . "ＬＤＬコレステロール")
    ("3J010000002327101" . "総ビリルビン")
    ("3J010000002399901" . "総ビリルビン")
    ("3B035000002327201" . "GOT（ＡＳＴ）")
    ("3B035000002399901" . "GOT（ＡＳＴ）")
    ("3B045000002327201" . "GPT（ＡＬＴ）")
    ("3B045000002399901" . "GPT（ＡＬＴ）")
    ("3B090000002327101" . "γ-GT(γ-GTP)")
    ("3B090000002399901" . "γ-GT(γ-GTP)")
    ("3B070000002327101" . "ＡＬＰ")
    ("3B070000002399901" . "ＡＬＰ")
    ("3C015000002327101" . "血清クレアチニン")
    ("3C015000002399901" . "血清クレアチニン")
    ("3C020000002327101" . "血清尿酸")
    ("3C020000002399901" . "血清尿酸")
    ("3A010000002327101" . "総蛋白")
    ("3A010000002399901" . "総蛋白")
    ("3A015000002327101" . "アルブミン")
    ("3A015000002399901" . "アルブミン")
    ("3A016000002327102" . "Ａ／Ｇ")
    ("5C095000002302301" . "血清フェリチン")
    ("5C095000002399901" . "血清フェリチン")
    ("3D010000001926101" . "空腹時血糖")
    ("3D010000002227101" . "空腹時血糖")
    ("3D010000001927201" . "空腹時血糖")
    ("3D010000001999901" . "空腹時血糖")
    ("3D010129901926101" . "随時血糖")
    ("3D010129902227101" . "随時血糖")
    ("3D010129901927201" . "随時血糖")
    ("3D010129901999901" . "随時血糖")
    ("3D045000001906202" . "ＨｂＡ１ｃ")
    ("3D045000001920402" . "ＨｂＡ１ｃ")
    ("3D045000001927102" . "ＨｂＡ１ｃ")
    ("3D045000001999902" . "ＨｂＡ１ｃ")
    ("1A020000000191111" . "尿糖")
    ("1A020000000190111" . "尿糖")
    ("1A010000000191111" . "尿蛋白")
    ("1A010000000190111" . "尿蛋白")
    ("1A100000000191111" . "尿潜血")
    ("1A100000000190111" . "尿潜血")
    ("1A105160700166211" . "尿沈渣（所見の有無）")
    ("1A105160800166249" . "尿沈渣（所見）")
    ("1A030000000190301" . "比重")
    ("1A030000000199901" . "比重")
    ("2A040000001930102" . "ヘマトクリット値")
    ("2A030000001930101" . "血色素量［ヘモグロビン値］")
    ("2A020000001930101" . "赤血球数")
    ("2A020161001930149" . "貧血検査（実施理由）")
    ("2A060000001930101" . "ＭＣＶ")
    ("2A070000001930101" . "ＭＣＨ")
    ("2A080000001930101" . "ＭＣＨＣ")
    ("2A010000001930101" . "白血球数")
    ("2A050000001930101" . "血小板数")
    ("9A110160700000011" . "心電図（所見の有無）")
    ("9A110160800000049" . "心電図（所見）")
    ("9A110161000000049" . "心電図（実施理由）")
    ("9N201000000000011" . "胸部エックス線検査（がん：直接撮影）")
    ("9N206160700000011" . "胸部エックス線検査（一般：直接撮影）（所見の有無）")
    ("9N206160800000049" . "胸部エックス線検査（一般：直接撮影）（所見）")
    ("9N211161100000049" . "胸部エックス線検査（直接撮影）（撮影年月日）")
    ("9N211161200000049" . "胸部エックス線検査（直接撮影）（フィルム番号）")
    ("9N216000000000011" . "胸部エックス線検査（がん：間接撮影）")
    ("9N221160700000011" . "胸部エックス線検査（一般：間接撮影）（所見の有無）")
    ("9N221160800000049" . "胸部エックス線検査（一般：間接撮影）（所見）")
    ("9N226161100000049" . "胸部エックス線検査（間接撮影）（撮影年月日）")
    ("9N226161200000049" . "胸部エックス線検査（間接撮影）（フィルム番号）")
    ("6A010160706170411" . "喀痰検査 （塗抹鏡検　一般細菌）（所見の有無）")
    ("6A010160806170449" . "喀痰検査 （塗抹鏡検　一般細菌）（所見）")
    ("6A205000006171711" . "喀痰検査（塗抹鏡検　抗酸菌）")
    ("6A205165606171711" . "喀痰検査（ガフキー号数）   ")
    ("7A010000006143311" . "喀痰細胞診検査")
    ("9N251000000000011" . "胸部ＣＴ検査（がん）")
    ("9N251160700000011" . "胸部ＣＴ検査（所見の有無）")
    ("9N251160800000049" . "胸部ＣＴ検査（所見）")
    ("9N251161100000049" . "胸部ＣＴ検査（撮影年月日）")
    ("9N251161200000049" . "胸部ＣＴ検査（フィルム番号）")
    ("9N256160700000011" . "上部消化管エックス線（直接撮影）（所見の有無）")
    ("9N256160800000049" . "上部消化管エックス線（直接撮影）（所見）")
    ("9N256161100000049" . "上部消化管エックス線（直接撮影）（撮影年月日）")
    ("9N256161200000049" . "上部消化管エックス線（直接撮影）（フィルム番号）")
    ("9N261160700000011" . "上部消化管エックス線（間接撮影）（所見の有無）")
    ("9N261160800000049" . "上部消化管エックス線（間接撮影）（所見）")
    ("9N261161100000049" . "上部消化管エックス線（間接撮影）（撮影年月日）")
    ("9N261161200000049" . "上部消化管エックス線（間接撮影）（フィルム番号）")
    ("9N266160700000011" . "上部消化管内視鏡検査（所見の有無）")
    ("9N266160800000049" . "上部消化管内視鏡検査（所見）")
    ("3B339000002399811" . "ペプシノゲン")
    ("9F130160700000011" . "腹部超音波（所見の有無）")
    ("9F130160800000049" . "腹部超音波（所見）")
    ("9N271160700000011" . "婦人科診察（所見の有無）")
    ("9N271160800000049" . "婦人科診察（所見）")
    ("9N276160700000011" . "乳房視触診（所見の有無）")
    ("9N276160800000049" . "乳房視触診（所見）")
    ("9N281160700000011" . "乳房画像診断（マンモグラフィー）（所見の有無）")
    ("9N281160800000049" . "乳房画像診断（マンモグラフィー）（所見）")
    ("9F140160700000011" . "乳房超音波検査（所見の有無）")
    ("9F140160800000049" . "乳房超音波検査（所見）")
    ("9N291160700000011" . "子宮頚部視診（所見の有無）")
    ("9N291160800000049" . "子宮頚部視診（所見）")
    ("9N296160700000011" . "子宮内診（所見の有無）")
    ("9N296160800000049" . "子宮内診(所見）")
    ("7A021165008543311" . "子宮頸部細胞診 (細胞診婦人科材料）（日母分類）")
    ("7A021165108543311" . "子宮頸部細胞診 (細胞診婦人科材料）（ベセスダ分類）")
    ("7A022000008543311" . "子宮体部細胞診 (細胞診婦人科材料）")
    ("9Z771160700000011" . "直腸肛門機能（2項目以上）（所見の有無）   ")
    ("9Z771160800000049" . "直腸肛門機能（2項目以上）（所見）  ")
    ("9Z770160700000011" . "直腸肛門機能（1項目）（所見の有無）")
    ("9Z770160800000049" . "直腸肛門機能（1項目）（所見）")
    ("1B030000001599811" . "便潜血")
    ("5D305000002399811" . "ＰＳＡ（前立腺特異抗原）")
    ("9C310000000000001" . "肺機能検査（努力肺活量）")
    ("9C320000000000001" . "肺機能検査（１秒量）")
    ("9C330000000000002" . "肺機能検査（１秒率）")
    ("9C380000000000002" . "肺機能検査（％ＶＣ）")
    ("9E160162100000001" . "視力（右）")
    ("9E160162500000001" . "視力（右：矯正）")
    ("9E160162200000001" . "視力（左）")
    ("9E160162600000001" . "視力（左：矯正）")
    ("9D100163100000011" . "聴力（右、1000Hz）")
    ("9D100163200000011" . "聴力（右、4000Hz）")
    ("9D100163500000011" . "聴力（左、1000Hz）")
    ("9D100163600000011" . "聴力（左、4000Hz）")
    ("9D100164000000011" . "聴力（検査方法）")
    ("9D100160900000049" . "聴力（その他の所見）")
    ("9E100166000000011" . "眼底検査（キースワグナー分類）")
    ("9E100166100000011" . "眼底検査（シェイエ分類：Ｈ）")
    ("9E100166200000011" . "眼底検査（シェイエ分類：Ｓ）")
    ("9E100166300000011" . "眼底検査（SCOTT分類)")
    ("9E100160900000049" . "眼底検査（その他の所見）")
    ("9E100161000000049" . "眼底検査（実施理由）")
    ("9E105162100000001" . "眼圧検査（右）")
    ("9E105162200000001" . "眼圧検査（左）")
    ("5C070000002306201" . "ＣＲＰ")
    ("5C070000002306301" . "ＣＲＰ")
    ("5C070000002399901" . "ＣＲＰ")
    ("5H010000001910111" . "血液型（ＡＢＯ）")
    ("5H010000001999911" . "血液型（ＡＢＯ）")
    ("5H020000001910111" . "血液型（Ｒｈ）")
    ("5H020000001999911" . "血液型（Ｒｈ）")
    ("5E071000002399811" . "梅毒反応")
    ("5F016141002399811" . "ＨＢｓ抗原")
    ("5F360149502399811" . "ＨＣＶ抗体     ")
    ("5F360149702399811" . "ＨＣＶ抗体（力価）")
    ("5F360150002399811" . "ＨＣＶ抗原検査")
    ("5F360145002399811" . "ＨＣＶ核酸増幅検査")
    ("9N401000000000011" . "Ｃ型肝炎ウイルス検診の判定")
    ("9N406000000000049" . "その他の法定特殊健康診断")
    ("9N411000000000049" . "その他の法定検査")
    ("9N416000000000049" . "その他の検査")
    ("9N501000000000011" . "メタボリックシンドローム判定")
    ("9N506000000000011" . "保健指導レベル")
    ("9N511000000000049" . "医師の診断（判定）")
    ("9N516000000000049" . "健康診断を実施した医師の氏名")
    ("9N521000000000049" . "医師の意見")
    ("9N526000000000049" . "意見を述べた医師の氏名")
    ("9N531000000000049" . "歯科医師による健康診断")
    ("9N536000000000049" . "歯科医師による健康診断を実施した歯科医師の氏名")
    ("9N541000000000049" . "歯科医師の意見")
    ("9N546000000000049" . "意見を述べた歯科医師の氏名")
    ("9N551000000000049" . "備考")
    ("9N556000000000011" . "生活機能評価の結果１")
    ("9N561000000000011" . "生活機能評価の結果２")
    ("9N566000000000049" . "生活機能評価の結果３")
    ("9N571000000000049" . "医師の診断（判定）（生活機能評価）")
    ("9N576000000000049" . "診断をした医師の氏名（生活機能評価）")
    ("9N581161300000011" . "医師の診断（肺がん検診）（コード）")
    ("9N581161400000049" . "医師の診断（肺がん検診）（自由記載）")
    ("9N586000000000049" . "診断をした医師の氏名（肺がん検診）")
    ("9N591161300000011" . "医師の診断（胃がん検診）（コード）")
    ("9N591161400000049" . "医師の診断（胃がん検診）（自由記載）")
    ("9N596000000000049" . "診断をした医師の氏名（胃がん検診）")
    ("9N601161300000011" . "医師の診断（乳がん検診）（コード）")
    ("9N601161400000049" . "医師の診断（乳がん検診）（自由記載）")
    ("9N606000000000049" . "診断をした医師の氏名（乳がん検診）")
    ("9N611161300000011" . "医師の診断（子宮がん検診）（コード）")
    ("9N611161400000049" . "医師の診断（子宮がん検診）（自由記載）")
    ("9N616000000000049" . "診断をした医師の氏名（子宮がん検診）")
    ("9N621161300000011" . "医師の診断（大腸がん検診）（コード）")
    ("9N621161400000049" . "医師の診断（大腸がん検診）（自由記載）")
    ("9N626000000000049" . "診断をした医師の氏名")
    ("9N631161300000011" . "医師の診断（前立腺がん検診）（コード）")
    ("9N631161400000049" . "医師の診断（前立腺がん検診）（自由記載）")
    ("9N636000000000049" . "診断を医師の氏名（前立腺がん検診）")
    ("9N641000000000049" . "医師の診断（その他）")
    ("9N646000000000049" . "診断をした医師の氏名（その他）")
    ("9N701000000000011" . "服薬１（血圧）")
    ("9N701167000000049" . "（薬剤）")
    ("9N701167100000049" . "（服薬理由）")
    ("9N706000000000011" . "服薬２（血糖）")
    ("9N706167000000049" . "（薬剤）")
    ("9N706167100000049" . "（服薬理由）")
    ("9N711000000000011" . "服薬３（脂質）")
    ("9N711167000000049" . "（薬剤）")
    ("9N711167100000049" . "（服薬理由）")
    ("9N716000000000011" . "既往歴１（脳血管）")
    ("9N721000000000011" . "既往歴２（心血管）")
    ("9N726000000000011" . "既往歴３（腎不全・人工透析）")
    ("9N731000000000011" . "貧血")
    ("9N736000000000011" . "喫煙")
    ("9N741000000000011" . "２０歳からの体重変化")
    ("9N746000000000011" . "３０分以上の運動習慣")
    ("9N751000000000011" . "歩行又は身体活動")
    ("9N756000000000011" . "歩行速度")
    ("9N761000000000011" . "1年間の体重変化")
    ("9N766000000000011" . "食べ方1（早食い等）")
    ("9N771000000000011" . "食べ方２（就寝前）")
    ("9N776000000000011" . "食べ方３（夜食/間食）")
    ("9N781000000000011" . "食習慣")
    ("9N786000000000011" . "飲酒")
    ("9N791000000000011" . "飲酒量")
    ("9N796000000000011" . "睡眠")
    ("9N801000000000011" . "生活習慣の改善")
    ("9N806000000000011" . "保健指導の希望")
    ("9N811000000000011" . "１．バスや電車で1人で外出していますか")
    ("9N816000000000011" . "２．日用品の買物をしていますか")
    ("9N821000000000011" . "３．預貯金の出し入れをしていますか")
    ("9N826000000000011" . "４．友人の家を訪ねていますか")
    ("9N831000000000011" . "５．家族や友人の相談にのっていますか")
    ("9N836000000000011" . "６．階段を手すりや壁をつたわらずに昇っていますか")
    ("9N841000000000011" . "７．椅子に座った状態から何もつかまらずに立ち上がっていますか")
    ("9N846000000000011" . "８．15分位続けて歩いていますか")
    ("9N851000000000011" . "９．この1年間に転んだことがありますか")
    ("9N856000000000011" . "１０．転倒に対する不安は大きいですか")
    ("9N861000000000011" . "１１．6ヵ月間で2〜3kg以上の体重減少がありましたか")
    ("9N866000000000001" . "１２．身長　　　　　ｃｍ　　　体重　　　　　ｋｇ　（ＢＭＩ＝　　　　）")
    ("9N871000000000011" . "１３．半年前に比べて固いものが食べにくくなりましたか")
    ("9N876000000000011" . "１４．お茶や汁物等でむせることがありますか")
    ("9N881000000000011" . "１５．口の渇きが気になりますか")
    ("9N886000000000011" . "１６．週に１回以上は外出していますか")
    ("9N891000000000011" . "１７．昨年と比べて外出の回数が減っていますか")
    ("9N896000000000011" . "１８．周りの人から「いつも同じ事を聞く」などの物忘れがあると言われますか")
    ("9N901000000000011" . "１９．自分で電話番号を調べて、電話をかけることをしていますか")
    ("9N906000000000011" . "２０．今日が何月何日かわからない時がありますか")
    ("9N911000000000011" . "２１．（ここ2週間）毎日の生活に充実感がない")
    ("9N916000000000011" . "２２．（ここ2週間）これまで楽しんでやれていたことが楽しめなくなった")
    ("9N921000000000011" . "２３．（ここ2週間）以前は楽にできていたことが今ではおっくうに感じられる")
    ("9N926000000000011" . "２４．（ここ2週間）自分が役に立つ人間だと思えない")
    ("9N931000000000011" . "２５．（ここ2週間）わけもなく疲れたような感じがする")))

(defun get-code (id)
  (cdr (assoc id kensin-code-gen)))

(defun get-id ()
  (let ((pre  (save-excursion (+ (re-search-backward "," (point-at-bol) t) 1)))
	(post (save-excursion (- (re-search-forward "," (point-at-eol) t) 1))))
    (buffer-substring-no-properties pre post)))

(defun get-kensin-code ()
  (interactive)
  (message (get-code (get-id))))

